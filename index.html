<!DOCTYPE html>
<html>
<head>
<title>Car Game</title>
<style>
body {
  margin: 0;
  background: black;
  overflow: hidden;
}

#gameArea {
  width: 300px;
  height: 600px;
  background: #222;
  margin: auto;
  position: relative;
  overflow: hidden;
}

.line {
  width: 10px;
  height: 100px;
  background: white;
  position: absolute;
  left: 145px;
}

#car {
  width: 50px;
  height: 90px;
  position: absolute;
  bottom: 10px;
  left: 125px;
}

.enemy {
  width: 50px;
  height: 90px;
  position: absolute;
}

#restartBtn {
  position: absolute;
  top: 250px;
  left: 90px;
  padding: 10px 20px;
  font-size: 18px;
  display: none;
}
</style>
</head>

<body>

<div id="gameArea">
  <img id="car" src="https://i.imgur.com/7QZ7Z6F.png">
  <button id="restartBtn">Restart</button>
</div>

<script>
let gameArea = document.getElementById("gameArea");
let car = document.getElementById("car");
let restartBtn = document.getElementById("restartBtn");

let carLeft = 125;
let speed = 5;
let gameOver = false;
let enemies = [];

// Create road lines
for(let i=0;i<6;i++){
  let line = document.createElement("div");
  line.classList.add("line");
  line.style.top = (i*120)+"px";
  gameArea.appendChild(line);
}

document.addEventListener("keydown", moveCar);

function moveCar(e){
  if(gameOver) return;

  if(e.key === "ArrowLeft" && carLeft > 0){
    carLeft -= 25;
  }
  if(e.key === "ArrowRight" && carLeft < 250){
    carLeft += 25;
  }

  car.style.left = carLeft + "px";
}

function createEnemy(){
  let enemy = document.createElement("img");
  enemy.src = "https://i.imgur.com/Z6X5Q9F.png";
  enemy.classList.add("enemy");
  enemy.style.top = "-100px";
  enemy.style.left = Math.floor(Math.random()*6)*50 + "px";
  gameArea.appendChild(enemy);
  enemies.push(enemy);
}

function moveEnemies(){
  enemies.forEach((enemy,index)=>{
    let enemyTop = parseInt(enemy.style.top);
    enemy.style.top = enemyTop + speed + "px";

    // Collision
    if(
      enemyTop > 480 &&
      parseInt(enemy.style.left) === carLeft
    ){
      endGame();
    }

    // Remove if off screen
    if(enemyTop > 600){
      enemy.remove();
      enemies.splice(index,1);
    }
  });
}

function moveLines(){
  let lines = document.querySelectorAll(".line");
  lines.forEach(line=>{
    let top = parseInt(line.style.top);
    top += speed;
    if(top > 600) top = -100;
    line.style.top = top + "px";
  });
}

function gameLoop(){
  if(gameOver) return;

  moveLines();
  moveEnemies();

  requestAnimationFrame(gameLoop);
}

setInterval(()=>{
  if(!gameOver) createEnemy();
},1500);

function endGame(){
  gameOver = true;
  restartBtn.style.display = "block";
}

restartBtn.onclick = function(){
  location.reload();
};

gameLoop();
</script>

</body>
</html>
